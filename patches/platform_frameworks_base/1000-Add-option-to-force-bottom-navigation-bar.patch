From 33aa8df367d75d20eae0fb09120fff87af464834 Mon Sep 17 00:00:00 2001
From: AndroPlus <mail@andro.plus>
Date: Sun, 2 Sep 2018 13:44:36 +0900
Subject: [PATCH 1/1] Add option to force bottom navigation bar

Change-Id: Id0b52d69877e35be8b062e852b0be3348486ac91
Signed-off-by: AndroPlus <mail@andro.plus>
---
 .../statusbar/phone/NavigationBarInflaterView.java |  8 +++++++-
 .../android/server/policy/PhoneWindowManager.java  | 14 +++++++++-----
 2 files changed, 16 insertions(+), 6 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarInflaterView.java b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarInflaterView.java
index e2aa54e6d21..25d124eef26 100644
--- a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarInflaterView.java
+++ b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarInflaterView.java
@@ -18,6 +18,7 @@ import android.annotation.Nullable;
 import android.content.Context;
 import android.content.res.Configuration;
 import android.graphics.drawable.Icon;
+import android.os.SystemProperties;
 import android.util.AttributeSet;
 import android.util.Log;
 import android.util.SparseArray;
@@ -129,8 +130,13 @@ public class NavigationBarInflaterView extends FrameLayout
         mRot0 = (FrameLayout) mLayoutInflater.inflate(R.layout.navigation_layout, this, false);
         mRot0.setId(R.id.rot0);
         addView(mRot0);
-        mRot90 = (FrameLayout) mLayoutInflater.inflate(R.layout.navigation_layout_rot90, this,
+        if (SystemProperties.get("config.force_bottom_navbar", "0").equals("1")) {
+            mRot90 = (FrameLayout) mLayoutInflater.inflate(R.layout.navigation_layout, this,
                 false);
+        } else {
+            mRot90 = (FrameLayout) mLayoutInflater.inflate(R.layout.navigation_layout_rot90, this,
+                false);
+        }
         mRot90.setId(R.id.rot90);
         addView(mRot90);
         updateAlternativeOrder();
diff --git a/services/core/java/com/android/server/policy/PhoneWindowManager.java b/services/core/java/com/android/server/policy/PhoneWindowManager.java
index 30fe24ddb68..51150c944d4 100644
--- a/services/core/java/com/android/server/policy/PhoneWindowManager.java
+++ b/services/core/java/com/android/server/policy/PhoneWindowManager.java
@@ -5642,11 +5642,15 @@ public class PhoneWindowManager implements WindowManagerPolicy {
     }

     private int navigationBarPosition(int displayWidth, int displayHeight, int displayRotation) {
-        if (mNavigationBarCanMove && displayWidth > displayHeight) {
-            if (displayRotation == Surface.ROTATION_270) {
-                return NAV_BAR_LEFT;
-            } else {
-                return NAV_BAR_RIGHT;
+        if (SystemProperties.get("config.force_bottom_navbar", "0").equals("1")) {
+            return NAV_BAR_BOTTOM;
+        } else {
+            if (mNavigationBarCanMove && displayWidth > displayHeight) {
+                if (displayRotation == Surface.ROTATION_270) {
+                    return NAV_BAR_LEFT;
+                } else {
+                    return NAV_BAR_RIGHT;
+                }
             }
         }
         return NAV_BAR_BOTTOM;
--
2.17.1
